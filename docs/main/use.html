
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>How to use pnumpy &#8212; PNumPy v2.0.20 documentation</title>
    <link rel="stylesheet" href="_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/language_data.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Installation" href="installation.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <div class="section" id="how-to-use-pnumpy">
<h1>How to use pnumpy<a class="headerlink" href="#how-to-use-pnumpy" title="Permalink to this headline">¶</a></h1>
<div class="section" id="module-pnumpy">
<span id="pnumpy-functions"></span><h2>pnumpy functions<a class="headerlink" href="#module-pnumpy" title="Permalink to this headline">¶</a></h2>
<p>Pnumpy now calls <code class="docutils literal notranslate"><span class="pre">init</span></code> at startup to setup the package. This imports NumPy,
replacing all the inner loops of UFuncs with wrapped versions. Then you can
enable/disable any of the subsystems:</p>
<blockquote>
<div><ul>
<li><p>threading</p>
<p>Threading will kick in when the number of elements to be processed is more
than 50,000. It will break the operation into chunks. Each chunk will be
executed in its own thread.</p>
</li>
<li><p>ledger</p>
<p>The ledger records data on each loop execution to
enable more accurate heuristics on memory allocation, threading behavior
and reporting for logging and benchmarking.</p>
</li>
<li><p>recycler</p>
<p>Once we can change the NumPy memory allocation strategy, we can use the
data from the ledger to create more performant memory caches.</p>
</li>
<li><p>atop</p>
<p>Provide faster implementations of NumPy inner loops.</p>
</li>
</ul>
</div></blockquote>
<dl class="py function">
<dt id="pnumpy.atop_disable">
<code class="sig-prename descclassname">pnumpy.</code><code class="sig-name descname">atop_disable</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pnumpy.atop_disable" title="Permalink to this definition">¶</a></dt>
<dd><p>disable the atop inner loop implementations.</p>
</dd></dl>

<dl class="py function">
<dt id="pnumpy.atop_enable">
<code class="sig-prename descclassname">pnumpy.</code><code class="sig-name descname">atop_enable</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pnumpy.atop_enable" title="Permalink to this definition">¶</a></dt>
<dd><p>enable the atop inner loop implementations.</p>
</dd></dl>

<dl class="py function">
<dt id="pnumpy.atop_info">
<code class="sig-prename descclassname">pnumpy.</code><code class="sig-name descname">atop_info</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pnumpy.atop_info" title="Permalink to this definition">¶</a></dt>
<dd><p>return dict</p>
</dd></dl>

<dl class="py function">
<dt id="pnumpy.atop_isenabled">
<code class="sig-prename descclassname">pnumpy.</code><code class="sig-name descname">atop_isenabled</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pnumpy.atop_isenabled" title="Permalink to this definition">¶</a></dt>
<dd><p>returns True if atop enabled, else False</p>
</dd></dl>

<dl class="py function">
<dt id="pnumpy.atop_setworkers">
<code class="sig-prename descclassname">pnumpy.</code><code class="sig-name descname">atop_setworkers</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pnumpy.atop_setworkers" title="Permalink to this definition">¶</a></dt>
<dd><p>set workers for a func</p>
</dd></dl>

<dl class="py function">
<dt id="pnumpy.disable">
<code class="sig-prename descclassname">pnumpy.</code><code class="sig-name descname">disable</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pnumpy.disable" title="Permalink to this definition">¶</a></dt>
<dd><p>Call to disable the atop engine, stop any threads, and unhook numpy functions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>None</strong> – </p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><code class="xref py py-func docutils literal notranslate"><span class="pre">pn.enable()</span></code>, <code class="xref py py-func docutils literal notranslate"><span class="pre">pn.atop_info()</span></code></p>
</div>
</dd></dl>

<dl class="py function">
<dt id="pnumpy.enable">
<code class="sig-prename descclassname">pnumpy.</code><code class="sig-name descname">enable</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pnumpy.enable" title="Permalink to this definition">¶</a></dt>
<dd><p>Call to enable the atop engine, use threads, and hook numpy functions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>None</strong> – </p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><code class="xref py py-func docutils literal notranslate"><span class="pre">pn.disable()</span></code>, <code class="xref py py-func docutils literal notranslate"><span class="pre">pn.atop_info()</span></code></p>
</div>
</dd></dl>

<dl class="py function">
<dt id="pnumpy.getitem">
<code class="sig-prename descclassname">pnumpy.</code><code class="sig-name descname">getitem</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pnumpy.getitem" title="Permalink to this definition">¶</a></dt>
<dd><p>alternative to fancy index or boolean index</p>
</dd></dl>

<dl class="py function">
<dt id="pnumpy.lexsort">
<code class="sig-prename descclassname">pnumpy.</code><code class="sig-name descname">lexsort</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">*</span><span class="n">args</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pnumpy.lexsort" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform an indirect stable sort using a sequence of keys.</p>
<p>Given multiple sorting keys, which can be interpreted as columns in a
spreadsheet, lexsort returns an array of integer indices that describes
the sort order by multiple columns. The last key in the sequence is used
for the primary sort order, the second-to-last key for the secondary sort
order, and so on. The keys argument must be a sequence of objects that
can be converted to arrays of the same shape. If a 2D array is provided
for the keys argument, it’s rows are interpreted as the sorting keys and
sorting is according to the last row, second last row etc.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>keys</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">(k</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">N)</span> <span class="pre">array</span></code> or <code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span> <span class="pre">containing</span> <span class="pre">k</span> <span class="pre">(N,)-shaped</span> <span class="pre">sequences</span></code>) – The <cite>k</cite> different “columns” to be sorted.  The last column (or row if
<cite>keys</cite> is a 2D array) is the primary sort key.</p></li>
<li><p><strong>axis</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <em>optional</em>) – Axis to be indirectly sorted.  By default, sort over the last axis.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>indices</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">(N,)</span> <span class="pre">ndarray</span></code> of <code class="xref py py-class docutils literal notranslate"><span class="pre">ints</span></code>) – Array of indices that sort the keys along the specified axis.</p></li>
<li><p><em>Threading</em></p></li>
<li><p><em>———</em></p></li>
<li><p><em>Up to 8 threads</em></p></li>
</ul>
</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><code class="xref py py-func docutils literal notranslate"><span class="pre">argsort()</span></code></dt><dd><p>Indirect sort.</p>
</dd>
<dt><code class="xref py py-func docutils literal notranslate"><span class="pre">ndarray.sort()</span></code></dt><dd><p>In-place sort.</p>
</dd>
<dt><a class="reference internal" href="#pnumpy.sort" title="pnumpy.sort"><code class="xref py py-func docutils literal notranslate"><span class="pre">sort()</span></code></a></dt><dd><p>Return a sorted copy of an array.</p>
</dd>
</dl>
</div>
<p class="rubric">Examples</p>
<p>Sort names: first by surname, then by name.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">surnames</span> <span class="o">=</span>    <span class="p">(</span><span class="s1">&#39;Hertz&#39;</span><span class="p">,</span>    <span class="s1">&#39;Galilei&#39;</span><span class="p">,</span> <span class="s1">&#39;Hertz&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">first_names</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;Heinrich&#39;</span><span class="p">,</span> <span class="s1">&#39;Galileo&#39;</span><span class="p">,</span> <span class="s1">&#39;Gustav&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ind</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">lexsort</span><span class="p">((</span><span class="n">first_names</span><span class="p">,</span> <span class="n">surnames</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ind</span>
<span class="go">array([1, 2, 0])</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="p">[</span><span class="n">surnames</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;, &quot;</span> <span class="o">+</span> <span class="n">first_names</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">ind</span><span class="p">]</span>
<span class="go">[&#39;Galilei, Galileo&#39;, &#39;Hertz, Gustav&#39;, &#39;Hertz, Heinrich&#39;]</span>
</pre></div>
</div>
<p>Sort two columns of numbers:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">]</span> <span class="c1"># First column</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span> <span class="o">=</span> <span class="p">[</span><span class="mi">9</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="c1"># Second column</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ind</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">lexsort</span><span class="p">((</span><span class="n">b</span><span class="p">,</span><span class="n">a</span><span class="p">))</span> <span class="c1"># Sort by a, then by b</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ind</span>
<span class="go">array([2, 0, 4, 6, 5, 3, 1])</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="p">[(</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">b</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">ind</span><span class="p">]</span>
<span class="go">[(1, 0), (1, 9), (3, 0), (4, 1), (4, 2), (4, 4), (5, 4)]</span>
</pre></div>
</div>
<p>Note that sorting is first according to the elements of <code class="docutils literal notranslate"><span class="pre">a</span></code>.
Secondary sorting is according to the elements of <code class="docutils literal notranslate"><span class="pre">b</span></code>.</p>
<p>A normal <code class="docutils literal notranslate"><span class="pre">argsort</span></code> would have yielded:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="p">[(</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">b</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">a</span><span class="p">)]</span>
<span class="go">[(1, 9), (1, 0), (3, 0), (4, 4), (4, 2), (4, 1), (5, 4)]</span>
</pre></div>
</div>
<p>Structured arrays are sorted lexically by <code class="docutils literal notranslate"><span class="pre">argsort</span></code>:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="mi">9</span><span class="p">),</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">4</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">),</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">1</span><span class="p">)],</span>
<span class="gp">... </span>             <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">dtype</span><span class="p">([(</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="nb">int</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="nb">int</span><span class="p">)]))</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="c1"># or np.argsort(x, order=(&#39;x&#39;, &#39;y&#39;))</span>
<span class="go">array([2, 0, 4, 6, 5, 3, 1])</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt id="pnumpy.recarray_to_colmajor">
<code class="sig-prename descclassname">pnumpy.</code><code class="sig-name descname">recarray_to_colmajor</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">item</span></em>, <em class="sig-param"><span class="n">parallel</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pnumpy.recarray_to_colmajor" title="Permalink to this definition">¶</a></dt>
<dd><p>Converts a numpy record array (void type) to a dictionary of numpy arrays, col major</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p></p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>A dictionary of numpy arrays corresponding to the original numpy record array.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="s1">&#39;this is a long test&#39;</span><span class="p">),</span> <span class="p">(</span><span class="mf">3.0</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="s1">&#39;short&#39;</span><span class="p">),</span> <span class="p">(</span><span class="mf">30.0</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="mi">70</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)],</span>
<span class="go">            dtype=[(&#39;x&#39;, &#39;&lt;f4&#39;), (&#39;y&#39;, &#39;&lt;i2&#39;), (&#39;z&#39;, &#39;i8&#39;),(&#39;zz&#39;,&#39;i8&#39;),(&#39;yy&#39;,&#39;i4&#39;),(&#39;str&#39;,&#39;&lt;S20&#39;)])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">item</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">tile</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="mi">100_000</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mydict</span> <span class="o">=</span> <span class="n">recarray_to_colmajor</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt id="pnumpy.sort">
<code class="sig-prename descclassname">pnumpy.</code><code class="sig-name descname">sort</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">a</span></em>, <em class="sig-param"><span class="n">axis</span><span class="o">=</span><span class="default_value">- 1</span></em>, <em class="sig-param"><span class="n">kind</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">order</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pnumpy.sort" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a sorted copy of an array.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>a</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">array_like</span></code>) – Array to be sorted.</p></li>
<li><p><strong>axis</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code> or <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>, <em>optional</em>) – Axis along which to sort. If None, the array is flattened before
sorting. The default is -1, which sorts along the last axis.</p></li>
<li><p><strong>kind</strong> (<code class="docutils literal notranslate"><span class="pre">{'quicksort',</span> <span class="pre">'mergesort',</span> <span class="pre">'heapsort',</span> <span class="pre">'stable'}</span></code>, <em>optional</em>) – <p>Sorting algorithm. The default is ‘quicksort’. Note that both ‘stable’
and ‘mergesort’ use timsort or radix sort under the covers and, in general,
the actual implementation will vary with data type. The ‘mergesort’ option
is retained for backwards compatibility.</p>
<div class="versionchanged">
<p><span class="versionmodified changed">Changed in version 1.15.0.: </span>The ‘stable’ option was added.</p>
</div>
</p></li>
<li><p><strong>order</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code> or <code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code> of <code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <em>optional</em>) – When <cite>a</cite> is an array with fields defined, this argument specifies
which fields to compare first, second, etc.  A single field can
be specified as a string, and not all fields need be specified,
but unspecified fields will still be used, in the order in which
they come up in the dtype, to break ties.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>sorted_array</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>) – Array of the same type and shape as <cite>a</cite>.</p></li>
<li><p><em>Threading</em></p></li>
<li><p><em>———</em></p></li>
<li><p><em>Up to 8 threads</em></p></li>
</ul>
</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><code class="xref py py-func docutils literal notranslate"><span class="pre">ndarray.sort()</span></code></dt><dd><p>Method to sort an array in-place.</p>
</dd>
<dt><code class="xref py py-func docutils literal notranslate"><span class="pre">argsort()</span></code></dt><dd><p>Indirect sort.</p>
</dd>
<dt><a class="reference internal" href="#pnumpy.lexsort" title="pnumpy.lexsort"><code class="xref py py-func docutils literal notranslate"><span class="pre">lexsort()</span></code></a></dt><dd><p>Indirect stable sort on multiple keys.</p>
</dd>
<dt><code class="xref py py-func docutils literal notranslate"><span class="pre">searchsorted()</span></code></dt><dd><p>Find elements in a sorted array.</p>
</dd>
<dt><code class="xref py py-func docutils literal notranslate"><span class="pre">partition()</span></code></dt><dd><p>Partial sort.</p>
</dd>
</dl>
</div>
<p class="rubric">Notes</p>
<p>The various sorting algorithms are characterized by their average speed,
worst case performance, work space size, and whether they are stable. A
stable sort keeps items with the same key in the same relative
order. The four algorithms implemented in NumPy have the following
properties:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 22%" />
<col style="width: 14%" />
<col style="width: 25%" />
<col style="width: 24%" />
<col style="width: 16%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>kind</p></th>
<th class="head"><p>speed</p></th>
<th class="head"><p>worst case</p></th>
<th class="head"><p>work space</p></th>
<th class="head"><p>stable</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>‘quicksort’</p></td>
<td><p>1</p></td>
<td><p>O(n^2)</p></td>
<td><p>0</p></td>
<td><p>no</p></td>
</tr>
<tr class="row-odd"><td><p>‘heapsort’</p></td>
<td><p>3</p></td>
<td><p>O(n*log(n))</p></td>
<td><p>0</p></td>
<td><p>no</p></td>
</tr>
<tr class="row-even"><td><p>‘mergesort’</p></td>
<td><p>2</p></td>
<td><p>O(n*log(n))</p></td>
<td><p>~n/2</p></td>
<td><p>yes</p></td>
</tr>
<tr class="row-odd"><td><p>‘timsort’</p></td>
<td><p>2</p></td>
<td><p>O(n*log(n))</p></td>
<td><p>~n/2</p></td>
<td><p>yes</p></td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The datatype determines which of ‘mergesort’ or ‘timsort’
is actually used, even if ‘mergesort’ is specified. User selection
at a finer scale is not currently available.</p>
</div>
<p>All the sort algorithms make temporary copies of the data when
sorting along any but the last axis.  Consequently, sorting along
the last axis is faster and uses less space than sorting along
any other axis.</p>
<p>The sort order for complex numbers is lexicographic. If both the real
and imaginary parts are non-nan then the order is determined by the
real parts except when they are equal, in which case the order is
determined by the imaginary parts.</p>
<p>Previous to numpy 1.4.0 sorting real and complex arrays containing nan
values led to undefined behaviour. In numpy versions &gt;= 1.4.0 nan
values are sorted to the end. The extended sort order is:</p>
<blockquote>
<div><ul class="simple">
<li><p>Real: [R, nan]</p></li>
<li><p>Complex: [R + Rj, R + nanj, nan + Rj, nan + nanj]</p></li>
</ul>
</div></blockquote>
<p>where R is a non-nan real value. Complex values with the same nan
placements are sorted according to the non-nan part if it exists.
Non-nan values are sorted as before.</p>
<div class="versionadded">
<p><span class="versionmodified added">New in version 1.12.0.</span></p>
</div>
<p>quicksort has been changed to <a class="reference external" href="https://en.wikipedia.org/wiki/Introsort">introsort</a>.
When sorting does not make enough progress it switches to
<a class="reference external" href="https://en.wikipedia.org/wiki/Heapsort">heapsort</a>.
This implementation makes quicksort O(n*log(n)) in the worst case.</p>
<p>‘stable’ automatically chooses the best stable sorting algorithm
for the data type being sorted.
It, along with ‘mergesort’ is currently mapped to
<a class="reference external" href="https://en.wikipedia.org/wiki/Timsort">timsort</a>
or <a class="reference external" href="https://en.wikipedia.org/wiki/Radix_sort">radix sort</a>
depending on the data type.
API forward compatibility currently limits the
ability to select the implementation and it is hardwired for the different
data types.</p>
<div class="versionadded">
<p><span class="versionmodified added">New in version 1.17.0.</span></p>
</div>
<p>Timsort is added for better performance on already or nearly
sorted data. On random data timsort is almost identical to
mergesort. It is now used for stable sort while quicksort is still the
default sort if none is chosen. For timsort details, refer to
<a class="reference external" href="https://github.com/python/cpython/blob/3.7/Objects/listsort.txt">CPython listsort.txt</a>.
‘mergesort’ and ‘stable’ are mapped to radix sort for integer data types. Radix sort is an
O(n) sort instead of O(n log n).</p>
<div class="versionchanged">
<p><span class="versionmodified changed">Changed in version 1.18.0.</span></p>
</div>
<p>NaT now sorts to the end of arrays for consistency with NaN.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">],[</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>                <span class="c1"># sort along the last axis</span>
<span class="go">array([[1, 4],</span>
<span class="go">       [1, 3]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>     <span class="c1"># sort the flattened array</span>
<span class="go">array([1, 1, 3, 4])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>        <span class="c1"># sort along the first axis</span>
<span class="go">array([[1, 1],</span>
<span class="go">       [3, 4]])</span>
</pre></div>
</div>
<p>Use the <cite>order</cite> keyword to specify a field to use when sorting a
structured array:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">dtype</span> <span class="o">=</span> <span class="p">[(</span><span class="s1">&#39;name&#39;</span><span class="p">,</span> <span class="s1">&#39;S10&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;height&#39;</span><span class="p">,</span> <span class="nb">float</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;age&#39;</span><span class="p">,</span> <span class="nb">int</span><span class="p">)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">values</span> <span class="o">=</span> <span class="p">[(</span><span class="s1">&#39;Arthur&#39;</span><span class="p">,</span> <span class="mf">1.8</span><span class="p">,</span> <span class="mi">41</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;Lancelot&#39;</span><span class="p">,</span> <span class="mf">1.9</span><span class="p">,</span> <span class="mi">38</span><span class="p">),</span>
<span class="gp">... </span>          <span class="p">(</span><span class="s1">&#39;Galahad&#39;</span><span class="p">,</span> <span class="mf">1.7</span><span class="p">,</span> <span class="mi">38</span><span class="p">)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">values</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">)</span>       <span class="c1"># create a structured array</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="s1">&#39;height&#39;</span><span class="p">)</span>                        
<span class="go">array([(&#39;Galahad&#39;, 1.7, 38), (&#39;Arthur&#39;, 1.8, 41),</span>
<span class="go">       (&#39;Lancelot&#39;, 1.8999999999999999, 38)],</span>
<span class="go">      dtype=[(&#39;name&#39;, &#39;|S10&#39;), (&#39;height&#39;, &#39;&lt;f8&#39;), (&#39;age&#39;, &#39;&lt;i4&#39;)])</span>
</pre></div>
</div>
<p>Sort by age, then height if ages are equal:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;age&#39;</span><span class="p">,</span> <span class="s1">&#39;height&#39;</span><span class="p">])</span>               
<span class="go">array([(&#39;Galahad&#39;, 1.7, 38), (&#39;Lancelot&#39;, 1.8999999999999999, 38),</span>
<span class="go">       (&#39;Arthur&#39;, 1.8, 41)],</span>
<span class="go">      dtype=[(&#39;name&#39;, &#39;|S10&#39;), (&#39;height&#39;, &#39;&lt;f8&#39;), (&#39;age&#39;, &#39;&lt;i4&#39;)])</span>
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="benchmarking">
<span id="id1"></span><h2>Benchmarking<a class="headerlink" href="#benchmarking" title="Permalink to this headline">¶</a></h2>
<span class="target" id="module-pnumpy.benchmark"></span><dl class="py function">
<dt id="pnumpy.benchmark.benchmark">
<code class="sig-prename descclassname">pnumpy.benchmark.</code><code class="sig-name descname">benchmark</code><span class="sig-paren">(</span><em class="sig-param">ctypes=[&lt;class 'numpy.bool_'&gt;, &lt;class 'numpy.int8'&gt;, &lt;class 'numpy.int16'&gt;, &lt;class 'numpy.int32'&gt;, &lt;class 'numpy.int64'&gt;, &lt;class 'numpy.float32'&gt;, &lt;class 'numpy.float64'&gt;], recycle=True, atop=True, thread=True, sizes=[1000000]</em><span class="sig-paren">)</span><a class="headerlink" href="#pnumpy.benchmark.benchmark" title="Permalink to this definition">¶</a></dt>
<dd><p>Performs a simple benchmark of the ratio of normal numpy (no threading) vs parallel numpy (threaded).
The output is formatted to be copied and pasted in a csv file.
A result above 1.0 indicates an improvement, below 1.0 indicates worse peformance.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ctypes</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code> of <code class="xref py py-class docutils literal notranslate"><span class="pre">numpy</span> <span class="pre">dtypes</span></code> to <code class="xref py py-class docutils literal notranslate"><span class="pre">test</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">for</span> <span class="pre">example</span> <span class="pre">[np.int32</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">npfloat32]</span></code>) – </p></li>
<li><p><strong>recycle</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code> or <code class="xref py py-obj docutils literal notranslate"><span class="pre">False</span></code>) – </p></li>
<li><p><strong>atop</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code> or <code class="xref py py-class docutils literal notranslate"><span class="pre">False.</span>&#160; <span class="pre">Whether</span></code> or <code class="xref py py-class docutils literal notranslate"><span class="pre">not</span> <span class="pre">the</span> <span class="pre">atop</span> <span class="pre">engine</span> <span class="pre">is</span> <span class="pre">used</span> <span class="pre">in</span> <span class="pre">benchmarking.</span></code>) – </p></li>
<li><p><strong>thread</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code> or <code class="xref py py-class docutils literal notranslate"><span class="pre">False.</span></code>) – </p></li>
<li><p><strong>sizes</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code> of <code class="xref py py-class docutils literal notranslate"><span class="pre">array</span> <span class="pre">sizes</span></code> to <code class="xref py py-class docutils literal notranslate"><span class="pre">test</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">for</span> <span class="pre">example</span> <span class="pre">[100_000</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">1_000_000]</span></code>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>output text formatted for a .csv file</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>pn.benchmark()
pn.benchmark(thread=False)
pn.benchmark(sizes=[2**16])
pn.benchmark(ctypes=[np.float32, np.float64])</p>
</dd></dl>

</div>
</div>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="index.html">PNumPy</a></h1>








<h3>Navigation</h3>
<p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="roadmap.html">Roadmap</a></li>
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">How to use pnumpy</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#module-pnumpy">pnumpy functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="#benchmarking">Benchmarking</a></li>
</ul>
</li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
      <li>Previous: <a href="installation.html" title="previous chapter">Installation</a></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2020-2021, tdimitri, mattip.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 3.2.0</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="_sources/use.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>